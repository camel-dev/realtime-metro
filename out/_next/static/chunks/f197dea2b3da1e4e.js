(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,42525,e=>{"use strict";var t=e.i(43476),n=e.i(71645);function i({onSidebarToggle:e}){return(0,t.jsx)("nav",{style:{padding:16,background:"#fff",borderBottom:"1px solid #eee",display:"flex",alignItems:"center"},children:(0,t.jsxs)("button",{onClick:e,"aria-label":"노선 선택!",style:{background:"#0052A4",color:"#fff",border:"none",borderRadius:8,padding:"8px 18px 8px 44px",fontSize:16,fontWeight:600,cursor:"pointer",position:"relative",boxShadow:"0 2px 8px 0 rgba(0,0,0,0.07)",marginRight:16,transition:"background 0.2s"},onMouseOver:e=>e.currentTarget.style.background="#003c7a",onMouseOut:e=>e.currentTarget.style.background="#0052A4",children:[(0,t.jsx)("span",{style:{position:"absolute",left:18,top:"50%",transform:"translateY(-50%)",width:18,height:18,display:"inline-block"},children:(0,t.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",children:[(0,t.jsx)("rect",{y:"3",width:"18",height:"2.5",rx:"1.2",fill:"#fff"}),(0,t.jsx)("rect",{y:"8",width:"18",height:"2.5",rx:"1.2",fill:"#fff"}),(0,t.jsx)("rect",{y:"13",width:"18",height:"2.5",rx:"1.2",fill:"#fff"})]})}),"노선 선택!"]})})}let r={1:"#0052A4",2:"#009D3E",3:"#EF7C1C",4:"#00A5DE",5:"#996CAC",6:"#CD7C2F",7:"#747F00",8:"#E6186C"},o=Object.keys(r).map(e=>({name:`${e}호선`,color:r[e],short:e}));function l({open:e,onClose:n,onSelectLine:i}){return e?(0,t.jsxs)("aside",{style:{position:"fixed",left:0,top:0,width:270,height:"100vh",background:"#f7f9fb",zIndex:1e3,padding:28,boxShadow:"2px 0 16px 0 rgba(0,0,0,0.07)",overflowY:"auto",fontFamily:"Pretendard, sans-serif"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:28},children:[(0,t.jsx)("h3",{style:{margin:0,fontSize:22,fontWeight:700,color:"#222"},children:"서울 지하철 노선"}),(0,t.jsx)("button",{onClick:n,"aria-label":"닫기",style:{background:"none",border:"none",fontSize:28,cursor:"pointer",color:"#888",lineHeight:1,padding:0},children:"×"})]}),(0,t.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:o.map(e=>(0,t.jsxs)("li",{onClick:()=>{i(e.short),n()},style:{cursor:"pointer",margin:"10px 0",display:"flex",alignItems:"center",borderRadius:10,padding:"8px 12px",transition:"background 0.15s",fontWeight:500,fontSize:16,userSelect:"none",boxShadow:"0 1px 2px rgba(0,0,0,0.03)"},onMouseOver:e=>e.currentTarget.style.background="#e6eef7",onMouseOut:e=>e.currentTarget.style.background="transparent",children:[(0,t.jsx)("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:"50%",background:e.color,color:"#fff",fontWeight:700,fontSize:16,marginRight:14,border:"2px solid #fff",boxShadow:"0 2px 8px 0 rgba(0,0,0,0.10)",textAlign:"center",lineHeight:1},children:e.short}),(0,t.jsx)("span",{style:{letterSpacing:.5},children:e.name})]},e.short))})]}):null}let s={1:"/realtime-metro/img/line1_v4.png",2:"/realtime-metro/img/line2_v4.png",3:"/realtime-metro/img/line3_v4.png",4:"/realtime-metro/img/line4_v4.png",5:"/realtime-metro/img/line5_v4.png",6:"/realtime-metro/img/line6_v4.png",7:"/realtime-metro/img/line7_v4.png",8:"/realtime-metro/img/line8_v4.png"},a={1:"#0052A4",2:"#00A84D",3:"#EF7C1C",4:"#00A2D1",5:"#996CAC",6:"#CD7C2F",7:"#747F00",8:"#E6186C"};function d({selectedLine:e}){let[i,r]=(0,n.useState)(1),o=(0,n.useRef)(null),[l,d]=(0,n.useState)({width:1,height:1}),c=(0,n.useRef)(null),h=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(!c.current)return;let e=()=>{d({width:c.current.width,height:c.current.height})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[e]);let[u,g]=(0,n.useState)([]);(0,n.useEffect)(()=>{if(!e)return;let t=async()=>{try{let t=`${e}호선`,n=await fetch(`https://metro.jys5540.workers.dev/?line=${t}`),i=await n.text(),r=new DOMParser().parseFromString(i,"text/xml"),o=Array.from(r.getElementsByTagName("row")).map(e=>({trainId:e.getElementsByTagName("trainNo")[0]?.textContent??"",statnNm:e.getElementsByTagName("statnNm")[0]?.textContent??"",statnTnm:e.getElementsByTagName("statnTnm")[0]?.textContent??"",updnLine:e.getElementsByTagName("updnLine")[0]?.textContent??"",directAt:e.getElementsByTagName("directAt")[0]?.textContent??"",trainSttus:e.getElementsByTagName("trainSttus")[0]?.textContent??""})),l=new Map;o.forEach(e=>{let t=`${e.trainId}-${e.statnNm}`;l.has(t)||l.set(t,e)});let s=Array.from(l.values());console.warn(s),g(s)}catch(e){g([])}};t();let n=setInterval(t,5e3);return()=>clearInterval(n)},[e]);let[p,f]=(0,n.useState)([]);return((0,n.useEffect)(()=>{"1"===e?fetch("/realtime-metro/line1_all_station_coords_updated.json").then(e=>e.json()).then(f):f([])},[e]),e&&s[e])?(0,t.jsx)("div",{ref:h,style:{width:"100vw",height:"calc(100dvh - 56px)",overflow:"auto",position:"relative",background:"#fafbfc"},onTouchStart:e=>{if(1===e.touches.length);else if(2===e.touches.length){let t=e.touches[0].clientX-e.touches[1].clientX,n=e.touches[0].clientY-e.touches[1].clientY;o.current={distance:Math.sqrt(t*t+n*n),scale:i}}},onTouchMove:e=>{if(1===e.touches.length);else if(2===e.touches.length&&o.current){let t=e.touches[0].clientX-e.touches[1].clientX,n=e.touches[0].clientY-e.touches[1].clientY,i=Math.sqrt(t*t+n*n);r(Math.max(.5,Math.min(3,o.current.scale*(i/o.current.distance))))}},onTouchEnd:e=>{o.current=null},children:(0,t.jsxs)("div",{style:{position:"relative",width:`${1200*i}px`,height:`${800*i}px`},children:[(0,t.jsx)("img",{ref:c,src:s[e],alt:`${e}호선 노선도`,style:{width:"100%",height:"100%",boxShadow:"0 4px 24px #0001",borderRadius:16,userSelect:"none",display:"block",cursor:"default"},draggable:!1,onLoad:()=>{c.current&&d({width:c.current.naturalWidth,height:c.current.naturalHeight})},onClick:e=>{let t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top,o=h.current?.scrollLeft??0,l=h.current?.scrollTop??0;console.log(`x: ${Math.round((n+o)/i)-1}, y: ${Math.round((r+l)/i)-1}`)}}),u.map(r=>{let o=p.filter(e=>"구로"===e.name?e.name===r.statnNm:e.name===r.statnNm&&e.trainSttus===r.trainSttus&&e.updnLine===r.updnLine);if(0===o.length)return null;let l=o[0],s=l.x*i,d=l.y*i,c=0,h=0;"2"!==e&&(["시청","서울","남영","용산","도봉산","도봉","방학","창동","녹천","월계","광운대","석계","가산디지털단지","독산","관악","안양","명학","금정","동암","간석","주안","도화"].includes(r.statnNm)?"0"===r.updnLine?c=-10:"1"===r.updnLine&&(c=13):"0"===r.updnLine?h=-5:"1"===r.updnLine&&(h=10));let u=s+c,g=d+h,f=a[e]||"#43a047",x="",m=f;"2"===e?"0"===r.updnLine?(x="↺",m=f):"1"===r.updnLine&&(x="↻",m=f):"0"===r.updnLine?(x="▲",m="#EF7C1C"):"1"===r.updnLine&&(x="▼",m="#00A2D1");let b="1"===r.directAt||"7"===r.directAt,y=`${r.trainId}-${r.statnNm}`;return(0,t.jsx)(n.default.Fragment,{children:(0,t.jsx)("div",{style:{position:"absolute",left:u-10,top:g-7,width:20,height:14,pointerEvents:"none",zIndex:2,display:"flex",alignItems:"center",justifyContent:"center"},title:r.trainId,children:(0,t.jsxs)("div",{style:{width:30,height:10,background:"rgba(255,255,255,0.7)",borderRadius:"10px 10px 10px 10px / 16px 16px 16px 16px",border:b?"1px solid #e53935":`1px solid ${f}`,boxShadow:"0 2px 8px #0002",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,t.jsxs)("span",{style:{fontSize:5,color:b?"#e53935":f,fontWeight:900,whiteSpace:"nowrap",textShadow:"0 2px 4px #fff",display:"flex",alignItems:"center"},children:[r.statnTnm,(0,t.jsx)("span",{style:{marginLeft:1,fontSize:5,fontWeight:"bold",color:m},children:x})]}),(0,t.jsx)("div",{style:{position:"absolute",left:2,bottom:-3,width:3,height:3,background:"#bbb",borderRadius:"50%"}}),(0,t.jsx)("div",{style:{position:"absolute",right:2,bottom:-3,width:3,height:3,background:"#bbb",borderRadius:"50%"}})]})})},y)})]})}):(0,t.jsx)("div",{style:{textAlign:"center",marginTop:100,color:"#888"},children:"노선을 선택하세요."})}function c({children:e}){let[r,o]=(0,n.useState)(!1),[s,a]=(0,n.useState)("1");return(0,t.jsx)("html",{lang:"en",children:(0,t.jsxs)("body",{style:{margin:0,overflow:"hidden"},children:[(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",zIndex:100,height:56,background:"#fff"},children:(0,t.jsx)(i,{onSidebarToggle:()=>o(!0)})}),(0,t.jsx)(l,{open:r,onClose:()=>o(!1),onSelectLine:e=>{a(e)}}),(0,t.jsx)("div",{style:{transition:"padding-left 0.3s",paddingLeft:290*!!r,minHeight:"100dvh",boxSizing:"border-box",background:"#f5f6fa",paddingTop:56},children:(0,t.jsx)(d,{selectedLine:s})})]})})}e.s(["default",()=>c],42525)}]);